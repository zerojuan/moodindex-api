#!/usr/bin/env node

const AWS = require( 'aws-sdk' );

AWS.config.update({
  endpoint: 'http://localhost:8000',
  region: 'us-east-2'
});


const db = new AWS.DynamoDB.DocumentClient();

function run() {
  console.log( 'Running DB import scripts' );

  // TODO: make this more dynamic
  const permissionsJson = require( '../data/permissions.json' );
  const users = require( '../data/users.json' );

  db.batchWrite( {
    RequestItems: permissionsJson
  } )
  .promise()
  .then( () => {
    return db.batchWrite( {
      RequestItems: users
    } ).promise()
  } );
}

if ( require.main === module ) {
  run();
}

module.exports = function() {
  run();
}
